% Έλεγχος Ελέγξιμου Συστήματος με LQR και παραμετροποίηση Q, R

% Ορισμός Πινάκων Α και Β
A = [0, 1, 0, 0;
     0, 0, -9.81, 0;
     0, 0, 0, 1;
     0, 0, 9.81, 0]; % Παράδειγμα συστήματος
B = [0; 0.1; 0; 0.2]; % Παράδειγμα εισόδων

% Έλεγχος δυνατότητας ελέγχου
Co = ctrb(A, B);
rank_Co = rank(Co);

disp('Βαθμίδα Πίνακα Ελέγχου:');
disp(rank_Co);

if rank_Co < size(A, 1)
    disp('Το σύστημα δεν είναι πλήρως ελέγξιμο.');
    return;
else
    disp('Το σύστημα είναι πλήρως ελέγξιμο.');
end

% Παράμετροι για πειραματισμούς
Q_values = [1, 10, 100]; % Τιμές για Q
R_values = [0.1, 1, 10]; % Τιμές για R

% Πειραματισμοί με διαφορετικές τιμές Q και R
for i = 1:length(Q_values)
    for j = 1:length(R_values)
        % Κατασκευή των Q και R
        Q = Q_values(i) * eye(size(A, 1)); % Διαγώνιος μήτρα Q
        R = R_values(j) * eye(size(B, 2)); % Διαγώνιος μήτρα R

        disp('====================================');
        disp(['Τιμές Q: ', num2str(Q_values(i)), ', R: ', num2str(R_values(j))]);

        % Υπολογισμός LQR
        try
            [K, S, e] = lqr(A, B, Q, R);
            disp('Πίνακας Κέρδους K:');
            disp(K);
            disp('Ιδιοτιμές Κλειστού Βρόχου:');
            disp(e);
        catch ME
            disp('Σφάλμα στον υπολογισμό του LQR:');
            disp(ME.message);
        end
    end
end
